import{j as e}from"./index-DdiTXruv.js";import{u as D,r as n}from"./router-BLsOe7s4.js";import{g as C,o as R,a as f,j as E,q as A,w as $,k as q,l as I,u as M}from"./firebase-D1iNbEvx.js";import"./vendor-D3F3s8fL.js";import"./query-C8hEkiZ5.js";function z(){const x=D(),[o,j]=n.useState(null),[r,y]=n.useState([]),[b,h]=n.useState(!0),[v,N]=n.useState(new Date);n.useEffect(()=>{const t=C(),s=R(t,a=>{j(a),a?i(a.uid):x("/login")});return()=>s()},[x]),n.useEffect(()=>{if(!o)return;const t=setInterval(()=>{i(o.uid),N(new Date)},3e4);return()=>clearInterval(t)},[o]);const i=async t=>{h(!0);try{const s=f(),a=E(s,"tasks"),m=A(a,$("userId","==",t)),c=await q(m),u=[];c.forEach(l=>{u.push({id:l.id,...l.data()})});const L=new Date().toISOString().split("T")[0],S=u.filter(l=>l.startDate===L).sort((l,g)=>{if(l.completed!==g.completed)return l.completed?1:-1;const p={high:3,medium:2,low:1};return p[g.priority]-p[l.priority]});y(S)}catch(s){console.error("Error loading tasks:",s)}finally{h(!1)}},w=async t=>{try{const s=f(),a=I(s,"tasks",t.id),m=t.completed?"active":"completed",c=!t.completed;await M(a,{status:m,completed:c,completedAt:c?new Date:null,updatedAt:new Date}),o&&await i(o.uid)}catch(s){console.error("Error toggling task:",s)}},T=t=>{switch(t){case"high":return"bg-red-500";case"medium":return"bg-yellow-500";case"low":return"bg-green-500";default:return"bg-gray-500"}},k=t=>t||"All day",d={total:r.length,completed:r.filter(t=>t.completed).length,pending:r.filter(t=>!t.completed).length,completionRate:r.length>0?Math.round(r.filter(t=>t.completed).length/r.length*100):0};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 p-4",children:e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-4 mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Today's Tasks"}),e.jsx("p",{className:"text-xs text-gray-500",children:new Date().toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})})]}),e.jsx("button",{onClick:()=>i(o?.uid),className:"p-2 hover:bg-gray-100 rounded-full transition-colors",title:"Refresh",children:e.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 mt-3",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-2 text-center",children:[e.jsx("div",{className:"text-xl font-bold text-blue-600",children:d.total}),e.jsx("div",{className:"text-xs text-blue-700",children:"Total"})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-2 text-center",children:[e.jsx("div",{className:"text-xl font-bold text-green-600",children:d.completed}),e.jsx("div",{className:"text-xs text-green-700",children:"Done"})]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-2 text-center",children:[e.jsxs("div",{className:"text-xl font-bold text-purple-600",children:[d.completionRate,"%"]}),e.jsx("div",{className:"text-xs text-purple-700",children:"Progress"})]})]}),e.jsx("div",{className:"mt-3",children:e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-purple-500 h-2 rounded-full transition-all duration-500",style:{width:`${d.completionRate}%`}})})})]}),e.jsx("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:b?e.jsxs("div",{className:"p-8 text-center text-gray-500",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2"}),"Loading..."]}):r.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("svg",{className:"mx-auto h-16 w-16 text-gray-400 mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("p",{className:"text-gray-600 font-medium mb-1",children:"No tasks for today"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Enjoy your free day! ðŸŽ‰"})]}):e.jsx("div",{className:"max-h-[500px] overflow-y-auto",children:r.map((t,s)=>e.jsx("div",{className:`p-3 border-b border-gray-100 hover:bg-gray-50 transition-colors ${t.completed?"opacity-60":""}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("button",{onClick:()=>w(t),className:`mt-0.5 flex-shrink-0 w-5 h-5 rounded border-2 transition-all ${t.completed?"bg-green-500 border-green-500":"border-gray-300 hover:border-blue-500"}`,children:t.completed&&e.jsx("svg",{className:"w-full h-full text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),e.jsx("div",{className:`flex-shrink-0 w-1 h-5 rounded-full ${T(t.priority)}`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:`text-sm font-medium ${t.completed?"line-through text-gray-400":"text-gray-800"}`,children:t.title}),t.description&&e.jsx("p",{className:`text-xs mt-0.5 ${t.completed?"text-gray-400":"text-gray-600"}`,children:t.description.length>50?t.description.substring(0,50)+"...":t.description}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:k(t.startTime)}),t.tags&&t.tags.length>0&&e.jsxs("span",{className:"text-xs text-gray-400",children:["â€¢ ",t.tags[0],t.tags.length>1&&` +${t.tags.length-1}`]})]})]})]})},t.id))})}),e.jsxs("div",{className:"mt-3 text-center",children:[e.jsx("button",{onClick:()=>x("/"),className:"text-xs text-gray-500 hover:text-blue-600 transition-colors",children:"Open Full App â†’"}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Last updated: ",v.toLocaleTimeString()]})]})]})})}export{z as default};
//# sourceMappingURL=Widget-BVfck42I.js.map
