{"version":3,"file":"Tasks-DkRjEmZo.js","sources":["../../src/pages/Tasks.tsx"],"sourcesContent":["import { useState, useEffect, useRef } from 'react';\nimport { getAuth, signOut } from 'firebase/auth';\nimport { getFirestore, collection, addDoc, query, where, getDocs, updateDoc, deleteDoc, doc, Timestamp } from 'firebase/firestore';\nimport { useNavigate, Link, useSearchParams } from 'react-router-dom';\n\ninterface Task {\n  id: string;\n  title: string;\n  description: string;\n  startDate: string;\n  startTime?: string;\n  status: 'todo' | 'in_progress' | 'completed';\n  priority: 'low' | 'medium' | 'high';\n  tags: string[];\n  isRepeating: boolean;\n  repeatFrequency?: 'daily' | 'weekly' | 'monthly';\n  repeatEndDate?: string;\n  userId: string;\n  createdAt: any;\n  completed?: boolean;\n}\n\nexport default function Tasks() {\n  const navigate = useNavigate();\n  const [searchParams] = useSearchParams();\n  const formRef = useRef<HTMLDivElement>(null);\n  const [tasks, setTasks] = useState<Task[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [showAddForm, setShowAddForm] = useState(false);\n  const [editingTask, setEditingTask] = useState<Task | null>(null);\n  const [user, setUser] = useState<any>(null);\n  const [sortBy, setSortBy] = useState<'priority' | 'time' | 'deadline' | 'date'>('priority');\n  const [statusFilter, setStatusFilter] = useState<'all' | 'active' | 'completed'>('all');\n  const [dateFilter, setDateFilter] = useState<'all' | 'today' | 'thisWeek' | 'thisMonth' | 'custom'>(\n    (searchParams.get('filter') as any) || 'all'\n  );\n  const [customDateStart, setCustomDateStart] = useState<string>('');\n  const [customDateEnd, setCustomDateEnd] = useState<string>('');\n\n  useEffect(() => {\n    const filterParam = searchParams.get('filter');\n    if (filterParam && ['all', 'today', 'thisWeek', 'thisMonth', 'custom'].includes(filterParam)) {\n      setDateFilter(filterParam as any);\n    }\n  }, [searchParams]);\n\n  const [formData, setFormData] = useState({\n    title: '',\n    description: '',\n    startDate: (() => {\n      const now = new Date();\n      return `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}-${String(now.getDate()).padStart(2, '0')}`;\n    })(), // Default to today\n    startTime: '',\n    priority: 'medium' as 'low' | 'medium' | 'high',\n    tags: '',\n    isRepeating: false,\n    repeatFrequency: 'daily' as 'daily' | 'weekly' | 'monthly',\n    repeatEndDate: ''\n  });\n\n  useEffect(() => {\n    const auth = getAuth();\n    const currentUser = auth.currentUser;\n    setUser(currentUser);\n\n    if (currentUser) {\n      loadTasks(currentUser.uid);\n    }\n  }, []);\n\n  const loadTasks = async (userId: string) => {\n    setLoading(true);\n    try {\n      const db = getFirestore();\n      const tasksRef = collection(db, 'tasks');\n      const q = query(tasksRef, where('userId', '==', userId));\n      const querySnapshot = await getDocs(q);\n\n      const loadedTasks: Task[] = [];\n      querySnapshot.forEach((doc) => {\n        loadedTasks.push({ id: doc.id, ...doc.data() } as Task);\n      });\n\n      setTasks(loadedTasks);\n    } catch (error) {\n      console.error('Error loading tasks:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleAddTask = async (e: React.FormEvent) => {\n    e.preventDefault();\n    console.log('Form submitted!', formData);\n\n    if (!user) {\n      console.error('No user found!');\n      alert('You must be logged in to create a task');\n      return;\n    }\n\n    try {\n      const db = getFirestore();\n\n      // Parse tags from comma-separated string\n      const tagArray = formData.tags\n        .split(',')\n        .map(tag => tag.trim())\n        .filter(tag => tag.length > 0);\n\n      // Use today's date if startDate is not set\n      const now = new Date();\n      const today = `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}-${String(now.getDate()).padStart(2, '0')}`;\n      const taskStartDate = formData.startDate || today;\n\n      const taskData = {\n        title: formData.title,\n        description: formData.description,\n        startDate: taskStartDate,\n        startTime: formData.startTime || null,\n        priority: formData.priority,\n        tags: tagArray,\n        isRepeating: formData.isRepeating,\n        repeatFrequency: formData.isRepeating ? formData.repeatFrequency : null,\n        repeatEndDate: formData.isRepeating ? formData.repeatEndDate : null,\n        status: 'todo',\n        userId: user.uid,\n        createdAt: Timestamp.now()\n      };\n\n      if (editingTask) {\n        // Update existing task\n        const taskRef = doc(db, 'tasks', editingTask.id);\n        await updateDoc(taskRef, taskData);\n        console.log('Task updated successfully');\n        alert('Task updated successfully!');\n      } else {\n        // Create new task\n        const tasksRef = collection(db, 'tasks');\n        const docRef = await addDoc(tasksRef, taskData);\n        console.log('Task created successfully with ID:', docRef.id);\n        alert('Task created successfully!');\n      }\n\n      // Reset form\n      setFormData({\n        title: '',\n        description: '',\n        startDate: today, // Default to today\n        startTime: '',\n        priority: 'medium',\n        tags: '',\n        isRepeating: false,\n        repeatFrequency: 'daily',\n        repeatEndDate: ''\n      });\n      setShowAddForm(false);\n      setEditingTask(null);\n\n      // Reload tasks\n      await loadTasks(user.uid);\n    } catch (error: any) {\n      console.error('Error saving task:', error);\n      alert(`Failed to save task: ${error.message}`);\n    }\n  };\n\n  const handleEditTask = (task: Task) => {\n    const now = new Date();\n    const today = `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}-${String(now.getDate()).padStart(2, '0')}`;\n\n    setEditingTask(task);\n    setFormData({\n      title: task.title,\n      description: task.description || '',\n      startDate: task.startDate || today, // Default to today if not set\n      startTime: task.startTime || '',\n      priority: task.priority,\n      tags: task.tags ? task.tags.join(', ') : '',\n      isRepeating: task.isRepeating || false,\n      repeatFrequency: task.repeatFrequency || 'daily',\n      repeatEndDate: task.repeatEndDate || ''\n    });\n    setShowAddForm(true);\n\n    // Scroll to form smoothly after a brief delay to allow React to render\n    setTimeout(() => {\n      formRef.current?.scrollIntoView({ behavior: 'smooth', block: 'start' });\n    }, 100);\n  };\n\n  const getNextOccurrenceDate = (currentDate: string, frequency: 'daily' | 'weekly' | 'monthly'): string => {\n    const date = new Date(currentDate);\n    switch (frequency) {\n      case 'daily':\n        date.setDate(date.getDate() + 1);\n        break;\n      case 'weekly':\n        date.setDate(date.getDate() + 7);\n        break;\n      case 'monthly':\n        date.setMonth(date.getMonth() + 1);\n        break;\n    }\n    return date.toISOString().split('T')[0];\n  };\n\n  const shouldCreateNextOccurrence = (task: Task): boolean => {\n    if (!task.isRepeating || !task.repeatFrequency) return false;\n    if (task.repeatEndDate) {\n      const endDate = new Date(task.repeatEndDate);\n      const nextDate = new Date(getNextOccurrenceDate(task.startDate, task.repeatFrequency));\n      return nextDate <= endDate;\n    }\n    return true; // No end date, repeat indefinitely\n  };\n\n  const handleToggleComplete = async (task: Task) => {\n    try {\n      const db = getFirestore();\n      const taskRef = doc(db, 'tasks', task.id);\n      const newStatus = task.status === 'completed' ? 'todo' : 'completed';\n\n      await updateDoc(taskRef, {\n        status: newStatus,\n        completed: newStatus === 'completed',\n        completedAt: newStatus === 'completed' ? new Date() : null,\n        updatedAt: new Date()\n      });\n\n      // If task is being marked as complete and is repeating, create next occurrence\n      if (newStatus === 'completed' && shouldCreateNextOccurrence(task)) {\n        const nextDate = getNextOccurrenceDate(task.startDate, task.repeatFrequency!);\n        const now = new Date();\n        const today = `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}-${String(now.getDate()).padStart(2, '0')}`;\n\n        // Only create if next occurrence is in the future or today\n        if (nextDate >= today) {\n          const nextTaskData = {\n            title: task.title,\n            description: task.description,\n            startDate: nextDate,\n            startTime: task.startTime || null,\n            status: 'todo',\n            priority: task.priority,\n            tags: task.tags || [],\n            isRepeating: task.isRepeating,\n            repeatFrequency: task.repeatFrequency,\n            repeatEndDate: task.repeatEndDate || null,\n            userId: task.userId,\n            createdAt: Timestamp.now(),\n            completed: false\n          };\n\n          await addDoc(collection(db, 'tasks'), nextTaskData);\n        }\n      }\n\n      if (user) {\n        loadTasks(user.uid);\n      }\n    } catch (error) {\n      console.error('Error toggling task:', error);\n      alert('Failed to update task');\n    }\n  };\n\n\n  const [deleteConfirmation, setDeleteConfirmation] = useState<{ show: boolean; taskId: string | null }>({\n    show: false,\n    taskId: null\n  });\n\n  // ... (existing useEffect)\n\n  // ... (existing loadTasks)\n\n  // ... (existing handleAddTask)\n\n  // ... (existing handleEditTask)\n\n  // ... (existing getNextOccurrenceDate)\n\n  // ... (existing shouldCreateNextOccurrence)\n\n  // ... (existing handleToggleComplete)\n\n  const confirmDeleteTask = (taskId: string) => {\n    setDeleteConfirmation({ show: true, taskId });\n  };\n\n  const handleDeleteTask = async () => {\n    if (!deleteConfirmation.taskId) return;\n\n    const taskId = deleteConfirmation.taskId;\n    setDeleteConfirmation({ show: false, taskId: null });\n\n    try {\n      const db = getFirestore();\n      const taskRef = doc(db, 'tasks', taskId);\n      await deleteDoc(taskRef);\n\n      // Reload tasks\n      if (user) {\n        loadTasks(user.uid);\n      }\n    } catch (error) {\n      console.error('Error deleting task:', error);\n      alert('Failed to delete task');\n    }\n  };\n\n  const handleLogout = async () => {\n    try {\n      const auth = getAuth();\n      await signOut(auth);\n      navigate('/login');\n    } catch (error) {\n      console.error('Logout error:', error);\n    }\n  };\n\n  const formatDateTime = (date: string, time?: string) => {\n    if (!date) return '';\n    const dateObj = new Date(date);\n    const dateStr = dateObj.toLocaleDateString();\n    if (time) {\n      return `${dateStr} ${time}`;\n    }\n    return dateStr;\n  };\n\n  const getPriorityColor = (priority: string) => {\n    switch (priority) {\n      case 'high': return 'bg-red-100 text-red-800';\n      case 'medium': return 'bg-yellow-100 text-yellow-800';\n      case 'low': return 'bg-green-100 text-green-800';\n      default: return 'bg-gray-100 text-gray-800';\n    }\n  };\n\n  const getPriorityValue = (priority: string): number => {\n    switch (priority) {\n      case 'high': return 3;\n      case 'medium': return 2;\n      case 'low': return 1;\n      default: return 0;\n    }\n  };\n\n  const getFilteredAndSortedTasks = (): Task[] => {\n    // First, filter by status\n    let filteredTasks = [...tasks];\n\n    if (statusFilter === 'active') {\n      filteredTasks = filteredTasks.filter(t => t.status !== 'completed' && !t.completed);\n    } else if (statusFilter === 'completed') {\n      filteredTasks = filteredTasks.filter(t => t.status === 'completed' || t.completed);\n    }\n\n    // Filter by date\n    if (dateFilter !== 'all') {\n      const now = new Date();\n      const today = `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}-${String(now.getDate()).padStart(2, '0')}`;\n\n      filteredTasks = filteredTasks.filter(task => {\n        if (!task.startDate) return false;\n        const taskDate = task.startDate.split('T')[0];\n\n        if (dateFilter === 'today') {\n          return taskDate === today;\n        } else if (dateFilter === 'thisWeek') {\n          const taskDateObj = new Date(taskDate);\n          const todayObj = new Date(today);\n          const firstDayOfWeek = new Date(todayObj);\n          firstDayOfWeek.setDate(todayObj.getDate() - todayObj.getDay()); // Sunday\n          const lastDayOfWeek = new Date(todayObj);\n          lastDayOfWeek.setDate(todayObj.getDate() + (6 - todayObj.getDay())); // Saturday\n          return taskDateObj >= firstDayOfWeek && taskDateObj <= lastDayOfWeek;\n        } else if (dateFilter === 'thisMonth') {\n          const taskDateObj = new Date(taskDate);\n          const todayObj = new Date(today);\n          return taskDateObj.getMonth() === todayObj.getMonth() && taskDateObj.getFullYear() === todayObj.getFullYear();\n        } else if (dateFilter === 'custom') {\n          if (customDateStart && taskDate < customDateStart) return false;\n          if (customDateEnd && taskDate > customDateEnd) return false;\n          return true;\n        }\n        return true;\n      });\n    }\n\n    // Separate completed and active tasks\n    const completedTasks = filteredTasks.filter(t => t.status === 'completed' || t.completed);\n    const activeTasks = filteredTasks.filter(t => t.status !== 'completed' && !t.completed);\n\n    // Sort active tasks based on selected sort option\n    let sortedActiveTasks: Task[] = [];\n\n    switch (sortBy) {\n      case 'priority':\n        sortedActiveTasks = activeTasks.sort((a, b) => getPriorityValue(b.priority) - getPriorityValue(a.priority));\n        break;\n\n      case 'time':\n        sortedActiveTasks = activeTasks.sort((a, b) => {\n          if (!a.startDate && !b.startDate) return 0;\n          if (!a.startDate) return 1;\n          if (!b.startDate) return -1;\n\n          const dateCompare = a.startDate.localeCompare(b.startDate);\n          if (dateCompare !== 0) return dateCompare;\n\n          // If same date, sort by time\n          const timeA = a.startTime || '23:59';\n          const timeB = b.startTime || '23:59';\n          return timeA.localeCompare(timeB);\n        });\n        break;\n\n      case 'deadline':\n        sortedActiveTasks = activeTasks.sort((a, b) => {\n          // Tasks with dates come first, sorted by earliest date\n          if (!a.startDate && !b.startDate) return 0;\n          if (!a.startDate) return 1; // Tasks without dates go to end\n          if (!b.startDate) return -1;\n\n          return a.startDate.localeCompare(b.startDate); // Nearest date first\n        });\n        break;\n\n      case 'date':\n        sortedActiveTasks = activeTasks.sort((a, b) => {\n          // Sort by date (ascending - earliest first)\n          if (!a.startDate && !b.startDate) return 0;\n          if (!a.startDate) return 1; // Tasks without dates go to end\n          if (!b.startDate) return -1;\n\n          return a.startDate.localeCompare(b.startDate);\n        });\n        break;\n\n      default:\n        sortedActiveTasks = activeTasks;\n    }\n\n    // Sort completed tasks by completion date (most recent first) or by same criteria\n    const sortedCompletedTasks = completedTasks.sort((a, b) => {\n      // If both have completion dates, sort by most recent\n      const aCompleted = (a as any).completedAt;\n      const bCompleted = (b as any).completedAt;\n\n      if (aCompleted && bCompleted) {\n        return new Date(bCompleted).getTime() - new Date(aCompleted).getTime();\n      }\n\n      // Otherwise sort by priority\n      return getPriorityValue(b.priority) - getPriorityValue(a.priority);\n    });\n\n    // Return active tasks first, then completed tasks\n    return [...sortedActiveTasks, ...sortedCompletedTasks];\n  };\n\n  const sortedTasks = getFilteredAndSortedTasks();\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      {/* ... (Header) ... */}\n      <div className=\"bg-white shadow\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"flex justify-between items-center py-6\">\n            <div>\n              <h1 className=\"text-3xl font-bold text-gray-900\">Tasks</h1>\n            </div>\n            <div className=\"flex items-center gap-4\">\n              <Link to=\"/\" className=\"text-sm text-gray-600 hover:text-gray-900\">\n                ‚Üê Back to Dashboard\n              </Link>\n              <button\n                onClick={handleLogout}\n                className=\"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-red-600 hover:bg-red-700\"\n              >\n                Logout\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Main Content */}\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n        {/* Add Task Button */}\n        <div className=\"mb-6\">\n          <button\n            onClick={() => {\n              setShowAddForm(!showAddForm);\n              setEditingTask(null);\n              setFormData({\n                title: '',\n                description: '',\n                startDate: '',\n                startTime: '',\n                priority: 'medium',\n                tags: '',\n                isRepeating: false,\n                repeatFrequency: 'daily',\n                repeatEndDate: ''\n              });\n            }}\n            className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-medium\"\n          >\n            {showAddForm ? '‚úï Cancel' : '+ Add New Task'}\n          </button>\n        </div>\n\n        {/* Add/Edit Task Form */}\n        {showAddForm && (\n          <div ref={formRef} className=\"bg-white rounded-lg shadow p-6 mb-6\">\n            <h2 className=\"text-xl font-semibold mb-4\">\n              {editingTask ? 'Edit Task' : 'Create New Task'}\n            </h2>\n            <form onSubmit={handleAddTask} className=\"space-y-4\">\n              {/* ... (Form fields) ... */}\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Task Title *\n                </label>\n                <input\n                  type=\"text\"\n                  required\n                  value={formData.title}\n                  onChange={(e) => setFormData({ ...formData, title: e.target.value })}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                  placeholder=\"Enter task title\"\n                />\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Description\n                </label>\n                <textarea\n                  value={formData.description}\n                  onChange={(e) => setFormData({ ...formData, description: e.target.value })}\n                  rows={3}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                  placeholder=\"Enter task description\"\n                />\n              </div>\n\n              {/* Start Date and Time */}\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Date\n                </label>\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div>\n                    <input\n                      type=\"date\"\n                      value={formData.startDate}\n                      onChange={(e) => setFormData({ ...formData, startDate: e.target.value })}\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                    />\n                  </div>\n                  <div>\n                    <input\n                      type=\"time\"\n                      value={formData.startTime}\n                      onChange={(e) => setFormData({ ...formData, startTime: e.target.value })}\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                      placeholder=\"Optional time\"\n                    />\n                    <p className=\"text-xs text-gray-500 mt-1\">Time is optional</p>\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Priority\n                  </label>\n                  <select\n                    value={formData.priority}\n                    onChange={(e) => setFormData({ ...formData, priority: e.target.value as any })}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                  >\n                    <option value=\"low\">Low</option>\n                    <option value=\"medium\">Medium</option>\n                    <option value=\"high\">High</option>\n                  </select>\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Tags (comma-separated)\n                  </label>\n                  <input\n                    type=\"text\"\n                    value={formData.tags}\n                    onChange={(e) => setFormData({ ...formData, tags: e.target.value })}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                    placeholder=\"work, urgent, meeting\"\n                  />\n                </div>\n              </div>\n\n              {/* Repeating Task Section */}\n              <div className=\"border-t pt-4\">\n                <div className=\"flex items-center mb-4\">\n                  <input\n                    type=\"checkbox\"\n                    id=\"isRepeating\"\n                    checked={formData.isRepeating}\n                    onChange={(e) => setFormData({ ...formData, isRepeating: e.target.checked })}\n                    className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\n                  />\n                  <label htmlFor=\"isRepeating\" className=\"ml-2 block text-sm font-medium text-gray-700\">\n                    üîÑ Make this a repeating task\n                  </label>\n                </div>\n\n                {formData.isRepeating && (\n                  <div className=\"ml-6 space-y-3 bg-blue-50 p-4 rounded-md\">\n                    <div className=\"grid grid-cols-2 gap-4\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          Repeat Frequency\n                        </label>\n                        <select\n                          value={formData.repeatFrequency}\n                          onChange={(e) => setFormData({ ...formData, repeatFrequency: e.target.value as any })}\n                          className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                        >\n                          <option value=\"daily\">Daily</option>\n                          <option value=\"weekly\">Weekly</option>\n                          <option value=\"monthly\">Monthly</option>\n                        </select>\n                      </div>\n\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          Repeat Until (End Date)\n                        </label>\n                        <input\n                          type=\"date\"\n                          value={formData.repeatEndDate}\n                          onChange={(e) => setFormData({ ...formData, repeatEndDate: e.target.value })}\n                          className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                        />\n                      </div>\n                    </div>\n                    <p className=\"text-xs text-gray-600\">\n                      This task will repeat {formData.repeatFrequency}\n                      {formData.repeatEndDate && ` until ${new Date(formData.repeatEndDate).toLocaleDateString()}`}\n                    </p>\n                  </div>\n                )}\n              </div>\n\n              <div className=\"flex gap-2\">\n                <button\n                  type=\"submit\"\n                  className=\"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-medium\"\n                >\n                  {editingTask ? 'Update Task' : 'Create Task'}\n                </button>\n                <button\n                  type=\"button\"\n                  onClick={() => {\n                    setShowAddForm(false);\n                    setEditingTask(null);\n                  }}\n                  className=\"px-6 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 font-medium\"\n                >\n                  Cancel\n                </button>\n              </div>\n            </form>\n          </div>\n        )}\n\n        {/* Tasks List */}\n        <div className=\"bg-white rounded-lg shadow\">\n          <div className=\"p-6 border-b border-gray-200\">\n            <h2 className=\"text-xl font-semibold mb-4\">Your Tasks ({sortedTasks.length})</h2>\n\n            {/* Status Tabs */}\n            <div className=\"flex border-b border-gray-200 mb-4\">\n              <button\n                onClick={() => setStatusFilter('all')}\n                className={`px-4 py-2 font-medium text-sm ${statusFilter === 'all'\n                  ? 'border-b-2 border-blue-600 text-blue-600'\n                  : 'text-gray-600 hover:text-gray-900'\n                  }`}\n              >\n                All ({tasks.length})\n              </button>\n              <button\n                onClick={() => setStatusFilter('active')}\n                className={`px-4 py-2 font-medium text-sm ${statusFilter === 'active'\n                  ? 'border-b-2 border-blue-600 text-blue-600'\n                  : 'text-gray-600 hover:text-gray-900'\n                  }`}\n              >\n                Active ({tasks.filter(t => t.status !== 'completed' && !t.completed).length})\n              </button>\n              <button\n                onClick={() => setStatusFilter('completed')}\n                className={`px-4 py-2 font-medium text-sm ${statusFilter === 'completed'\n                  ? 'border-b-2 border-blue-600 text-blue-600'\n                  : 'text-gray-600 hover:text-gray-900'\n                  }`}\n              >\n                Completed ({tasks.filter(t => t.status === 'completed' || t.completed).length})\n              </button>\n            </div>\n\n            {/* Filters and Sort */}\n            <div className=\"flex flex-wrap items-center gap-4\">\n              {/* Date Filter */}\n              <div className=\"flex items-center gap-2\">\n                <label className=\"text-sm font-medium text-gray-700\">Date:</label>\n                <select\n                  value={dateFilter}\n                  onChange={(e) => setDateFilter(e.target.value as 'all' | 'today' | 'thisWeek' | 'thisMonth' | 'custom')}\n                  className=\"px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                >\n                  <option value=\"all\">All Dates</option>\n                  <option value=\"today\">Today</option>\n                  <option value=\"thisWeek\">This Week</option>\n                  <option value=\"thisMonth\">This Month</option>\n                  <option value=\"custom\">Custom Range</option>\n                </select>\n              </div>\n\n              {/* Custom Date Range */}\n              {dateFilter === 'custom' && (\n                <div className=\"flex items-center gap-2\">\n                  <input\n                    type=\"date\"\n                    value={customDateStart}\n                    onChange={(e) => setCustomDateStart(e.target.value)}\n                    placeholder=\"Start Date\"\n                    className=\"px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                  />\n                  <span className=\"text-gray-500\">to</span>\n                  <input\n                    type=\"date\"\n                    value={customDateEnd}\n                    onChange={(e) => setCustomDateEnd(e.target.value)}\n                    placeholder=\"End Date\"\n                    className=\"px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                  />\n                </div>\n              )}\n\n              {/* Sort Dropdown */}\n              <div className=\"flex items-center gap-2 ml-auto\">\n                <label className=\"text-sm font-medium text-gray-700\">Sort by:</label>\n                <select\n                  value={sortBy}\n                  onChange={(e) => setSortBy(e.target.value as 'priority' | 'time' | 'deadline' | 'date')}\n                  className=\"px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                >\n                  <option value=\"priority\">Priority (High to Low)</option>\n                  <option value=\"date\">Date (Earliest First)</option>\n                  <option value=\"time\">Date & Time</option>\n                  <option value=\"deadline\">Deadline (Nearest First)</option>\n                </select>\n              </div>\n            </div>\n          </div>\n\n          {loading ? (\n            <div className=\"p-8 text-center text-gray-500\">Loading tasks...</div>\n          ) : tasks.length === 0 ? (\n            <div className=\"p-8 text-center text-gray-500\">\n              No tasks yet. Click \"Add New Task\" to create one!\n            </div>\n          ) : sortedTasks.length === 0 ? (\n            <div className=\"p-8 text-center text-gray-500\">\n              No tasks match the selected filter.\n            </div>\n          ) : (\n            <div className=\"divide-y divide-gray-200\">\n              {sortedTasks.map((task) => (\n                <div key={task.id} className=\"p-4 hover:bg-gray-50 flex items-start gap-3\">\n                  {/* Checkbox */}\n                  <input\n                    type=\"checkbox\"\n                    checked={task.status === 'completed'}\n                    onChange={() => handleToggleComplete(task)}\n                    className=\"mt-1 h-5 w-5 text-blue-600 rounded focus:ring-blue-500 cursor-pointer\"\n                  />\n\n                  {/* Task Content */}\n                  <div className=\"flex-1\">\n                    <div className=\"flex items-center gap-2 mb-1\">\n                      <h3 className={`text-base font-medium ${task.status === 'completed' ? 'line-through text-gray-400' : 'text-gray-900'}`}>\n                        {task.title}\n                      </h3>\n                      <span className={`px-2 py-0.5 text-xs font-medium rounded ${getPriorityColor(task.priority)}`}>\n                        {task.priority}\n                      </span>\n                      {task.isRepeating && (\n                        <span className=\"px-2 py-0.5 text-xs font-medium rounded bg-purple-100 text-purple-800\">\n                          üîÑ {task.repeatFrequency}\n                        </span>\n                      )}\n                    </div>\n\n                    {task.description && (\n                      <p className={`text-sm mb-1 ${task.status === 'completed' ? 'text-gray-400' : 'text-gray-600'}`}>\n                        {task.description}\n                      </p>\n                    )}\n\n                    <div className=\"flex flex-wrap gap-3 text-xs text-gray-500 mb-1\">\n                      {task.startDate && (\n                        <span>\n                          üìÖ {formatDateTime(task.startDate, task.startTime)}\n                        </span>\n                      )}\n                      {task.isRepeating && task.repeatEndDate && (\n                        <span>\n                          üîö Until: {new Date(task.repeatEndDate).toLocaleDateString()}\n                        </span>\n                      )}\n                    </div>\n\n                    {task.tags && task.tags.length > 0 && (\n                      <div className=\"flex flex-wrap gap-1 mt-1\">\n                        {task.tags.map((tag, index) => (\n                          <span\n                            key={index}\n                            className=\"px-2 py-0.5 text-xs bg-indigo-100 text-indigo-800 rounded\"\n                          >\n                            #{tag}\n                          </span>\n                        ))}\n                      </div>\n                    )}\n                  </div>\n\n                  {/* Action Buttons */}\n                  <div className=\"flex gap-2\">\n                    <button\n                      onClick={() => handleEditTask(task)}\n                      className=\"px-3 py-1 text-xs bg-gray-600 text-white rounded hover:bg-gray-700\"\n                    >\n                      Edit\n                    </button>\n                    <button\n                      onClick={() => confirmDeleteTask(task.id)}\n                      className=\"px-3 py-1 text-xs bg-red-600 text-white rounded hover:bg-red-700\"\n                    >\n                      Delete\n                    </button>\n                  </div>\n                </div>\n              ))}\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Delete Confirmation Modal */}\n      {deleteConfirmation.show && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4\" onClick={() => setDeleteConfirmation({ show: false, taskId: null })}>\n          <div className=\"bg-white rounded-lg shadow-xl max-w-sm w-full p-6\" onClick={(e) => e.stopPropagation()}>\n            <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">Delete Task</h3>\n            <p className=\"text-gray-600 mb-6\">\n              Are you sure you want to delete this task? This action cannot be undone.\n            </p>\n            <div className=\"flex justify-end gap-3\">\n              <button\n                onClick={() => setDeleteConfirmation({ show: false, taskId: null })}\n                className=\"px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 font-medium\"\n              >\n                Cancel\n              </button>\n              <button\n                onClick={handleDeleteTask}\n                className=\"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 font-medium\"\n              >\n                Delete\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":["Tasks","navigate","useNavigate","searchParams","useSearchParams","formRef","useRef","tasks","setTasks","useState","loading","setLoading","showAddForm","setShowAddForm","editingTask","setEditingTask","user","setUser","sortBy","setSortBy","statusFilter","setStatusFilter","dateFilter","setDateFilter","customDateStart","setCustomDateStart","customDateEnd","setCustomDateEnd","useEffect","filterParam","formData","setFormData","now","currentUser","getAuth","loadTasks","userId","db","getFirestore","tasksRef","collection","q","query","where","querySnapshot","getDocs","loadedTasks","doc","error","handleAddTask","tagArray","tag","today","taskStartDate","taskData","Timestamp","taskRef","updateDoc","docRef","addDoc","handleEditTask","task","getNextOccurrenceDate","currentDate","frequency","date","shouldCreateNextOccurrence","endDate","handleToggleComplete","newStatus","nextDate","nextTaskData","deleteConfirmation","setDeleteConfirmation","confirmDeleteTask","taskId","handleDeleteTask","deleteDoc","handleLogout","auth","signOut","formatDateTime","time","dateStr","getPriorityColor","priority","getPriorityValue","sortedTasks","filteredTasks","t","taskDate","taskDateObj","todayObj","firstDayOfWeek","lastDayOfWeek","completedTasks","activeTasks","sortedActiveTasks","b","dateCompare","timeA","timeB","sortedCompletedTasks","aCompleted","bCompleted","jsxs","jsx","Link","index"],"mappings":"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"}