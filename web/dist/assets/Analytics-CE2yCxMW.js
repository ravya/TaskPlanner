import{j as e}from"./index-DwcSQX-o.js";import{u as C,r as h,L}from"./router-BLsOe7s4.js";import{g as v,a as A,f as E,q as B,w as q,h as W,s as I}from"./firebase-DdGZ2tPu.js";import"./vendor-D3F3s8fL.js";import"./query-C8hEkiZ5.js";function F(){const g=C(),[b,w]=h.useState([]),[k,j]=h.useState(!0),[i,u]=h.useState("week");h.useEffect(()=>{const a=v().currentUser;a?M(a.uid):g("/login")},[g]);const M=async t=>{j(!0);try{const a=A(),o=E(a,"tasks"),s=B(o,q("userId","==",t)),l=await W(s),n=[];l.forEach(r=>{n.push({id:r.id,...r.data()})}),w(n)}catch(a){console.error("Error loading tasks:",a)}finally{j(!1)}},T=async()=>{try{const t=v();await I(t),g("/login")}catch(t){console.error("Logout error:",t)}},c=()=>{const t=new Date,a=i==="week"?7:i==="month"?30:90,o=[];for(let s=a-1;s>=0;s--){const l=new Date(t);l.setDate(l.getDate()-s);const n=l.toISOString().split("T")[0],r=b.filter(x=>x.startDate===n),N=r.filter(x=>x.status==="completed"||x.completed);o.push({date:n,total:r.length,completed:N.length,completionRate:r.length>0?N.length/r.length*100:0})}return o},D=()=>{const a=c().filter(s=>s.total>0);if(a.length===0)return 0;const o=a.reduce((s,l)=>s+l.total,0);return Math.round(o/a.length*10)/10},p=()=>{const a=c().filter(s=>s.total>0);if(a.length===0)return 0;const o=a.reduce((s,l)=>s+l.completionRate,0);return Math.round(o/a.length)},$=()=>{const a=c().filter(o=>o.total>0);if(i==="week"&&a.length>=7){const o=a.map(n=>n.completed),s=o.reduce((n,r)=>n+r,0)/o.length,l=p();return l>=70?{min:Math.floor(s*.9),max:Math.ceil(s*1.1),message:`Great job! You're completing ${l}% of your tasks. Keep your daily tasks between ${Math.floor(s*.9)}-${Math.ceil(s*1.1)} to maintain this performance.`}:l>=50?{min:Math.floor(s*.7),max:Math.ceil(s*.9),message:`You're completing ${l}% of your tasks. Try reducing your daily tasks to ${Math.floor(s*.7)}-${Math.ceil(s*.9)} to improve completion rate.`}:{min:Math.floor(s*.5),max:Math.ceil(s*.7),message:`Your completion rate is ${l}%. Consider reducing your daily tasks to ${Math.floor(s*.5)}-${Math.ceil(s*.7)} for better success.`}}if(i==="3months"&&a.length>=21){const o=a.map(n=>n.completed),s=o.reduce((n,r)=>n+r,0)/o.length,l=p();return l>=70?{min:Math.floor(s*.9),max:Math.ceil(s*1.1),message:`Excellent consistency over 3 weeks! ${l}% completion rate. Maintain ${Math.floor(s*.9)}-${Math.ceil(s*1.1)} tasks daily.`}:{min:Math.floor(s*.6),max:Math.ceil(s*.8),message:`Based on 3 weeks of data (${l}% completion), aim for ${Math.floor(s*.6)}-${Math.ceil(s*.8)} tasks daily.`}}return null},d=c(),y=Math.max(...d.map(t=>t.total),1),S=D(),R=p(),m=$(),f=t=>new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric"});return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white shadow",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between items-center py-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Task Analytics"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Insights into your task completion patterns"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(L,{to:"/",className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"â† Back to Dashboard"}),e.jsx("button",{onClick:T,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 font-medium",children:"Logout"})]})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:k?e.jsx("div",{className:"text-center py-12",children:e.jsx("div",{className:"text-gray-500",children:"Loading analytics..."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>u("week"),className:`px-4 py-2 rounded-md font-medium ${i==="week"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Last 7 Days"}),e.jsx("button",{onClick:()=>u("month"),className:`px-4 py-2 rounded-md font-medium ${i==="month"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Last 30 Days"}),e.jsx("button",{onClick:()=>u("3months"),className:`px-4 py-2 rounded-md font-medium ${i==="3months"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Last 90 Days"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Average Tasks/Day"}),e.jsx("div",{className:"text-3xl font-bold text-blue-600",children:S}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Tasks scheduled per day"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Completion Rate"}),e.jsxs("div",{className:"text-3xl font-bold text-green-600",children:[R,"%"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Average completion rate"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Total Tasks"}),e.jsx("div",{className:"text-3xl font-bold text-purple-600",children:b.length}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"All time"})]})]}),m&&e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 border-2 border-blue-200 rounded-lg shadow-lg p-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("svg",{className:"w-6 h-6 text-blue-600 mt-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-2",children:"Suggested Daily Target"}),e.jsx("p",{className:"text-sm text-blue-800 mb-3",children:m.message}),e.jsxs("div",{className:"inline-block px-4 py-2 bg-blue-600 text-white rounded-md font-bold",children:["Target: ",m.min," - ",m.max," tasks/day"]})]})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-6",children:"Daily Task Completion"}),e.jsx("div",{className:"space-y-3",children:d.map(t=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"font-medium text-gray-700",children:f(t.date)}),e.jsxs("span",{className:"text-gray-600",children:[t.completed,"/",t.total," tasks (",Math.round(t.completionRate),"%)"]})]}),e.jsxs("div",{className:"relative h-8 bg-gray-100 rounded-full overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 h-full bg-blue-200",style:{width:`${t.total/y*100}%`}}),e.jsx("div",{className:"absolute top-0 left-0 h-full bg-blue-600",style:{width:`${t.completed/y*100}%`}}),t.total>0&&e.jsxs("div",{className:"absolute inset-0 flex items-center justify-between px-3",children:[e.jsx("span",{className:"text-xs font-medium text-white",children:t.completed>0&&`âœ“ ${t.completed}`}),e.jsxs("span",{className:"text-xs font-medium text-gray-700",children:[t.total," total"]})]})]})]},t.date))}),e.jsxs("div",{className:"mt-6 flex items-center gap-6 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-blue-600 rounded"}),e.jsx("span",{className:"text-gray-600",children:"Completed Tasks"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-blue-200 rounded"}),e.jsx("span",{className:"text-gray-600",children:"Total Tasks"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Best Performing Days"}),d.filter(t=>t.total>0).sort((t,a)=>a.completionRate-t.completionRate).slice(0,5).map((t,a)=>e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100 last:border-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:a===0?"ðŸ¥‡":a===1?"ðŸ¥ˆ":a===2?"ðŸ¥‰":"ðŸ“Š"}),e.jsx("span",{className:"font-medium text-gray-700",children:f(t.date)})]}),e.jsxs("span",{className:"text-green-600 font-semibold",children:[Math.round(t.completionRate),"%"]})]},t.date))]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Busiest Days"}),d.filter(t=>t.total>0).sort((t,a)=>a.total-t.total).slice(0,5).map((t,a)=>e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100 last:border-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:a===0?"ðŸ“ˆ":"ðŸ“Š"}),e.jsx("span",{className:"font-medium text-gray-700",children:f(t.date)})]}),e.jsxs("span",{className:"text-purple-600 font-semibold",children:[t.total," tasks"]})]},t.date))]})]})]})})]})}export{F as default};
//# sourceMappingURL=Analytics-CE2yCxMW.js.map
